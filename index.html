<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Algebraic Maximum Likelihood Estimators • algebraic.mle</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Algebraic Maximum Likelihood Estimators">
<meta name="description" content="The maximum likelihood estimator (MLE) is a technology: under regularity conditions, any MLE is asymptotically normal with variance given by the inverse Fisher information. This package exploits that structure by defining an algebra over MLEs. Compose independent estimators into joint MLEs via block-diagonal covariance (joint), optimally combine repeated estimates via inverse-variance weighting (combine), propagate transformations via the delta method (rmap), and bridge to distribution algebra via conversion to normal or multivariate normal objects (as_dist). Supports asymptotic (mle, mle_numerical) and bootstrap (mle_boot) estimators with a unified interface for inference: confidence intervals, standard errors, AIC, Fisher information, and predictive intervals. For background on maximum likelihood estimation, see Casella and Berger (2002, ISBN:978-0534243128). For the delta method and variance estimation, see Lehmann and Casella (1998, ISBN:978-0387985022).">
<meta property="og:description" content="The maximum likelihood estimator (MLE) is a technology: under regularity conditions, any MLE is asymptotically normal with variance given by the inverse Fisher information. This package exploits that structure by defining an algebra over MLEs. Compose independent estimators into joint MLEs via block-diagonal covariance (joint), optimally combine repeated estimates via inverse-variance weighting (combine), propagate transformations via the delta method (rmap), and bridge to distribution algebra via conversion to normal or multivariate normal objects (as_dist). Supports asymptotic (mle, mle_numerical) and bootstrap (mle_boot) estimators with a unified interface for inference: confidence intervals, standard errors, AIC, Fisher information, and predictive intervals. For background on maximum likelihood estimation, see Casella and Berger (2002, ISBN:978-0534243128). For the delta method and variance estimation, see Lehmann and Casella (1998, ISBN:978-0387985022).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">algebraic.mle</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/dgp.html">Dynamic failure rate model</a></li>
    <li><a class="dropdown-item" href="articles/fitting-common-dist.html">Fitting Common Distributions to a DGP</a></li>
    <li><a class="dropdown-item" href="articles/mle-algebra.html">The Algebra of MLEs</a></li>
    <li><a class="dropdown-item" href="articles/statistics.html">Statistics and characteristics of the MLE</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/queelius/algebraic.mle/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="algebraicmle">algebraic.mle<a class="anchor" aria-label="anchor" href="#algebraicmle"></a>
</h1></div>
<!-- badges: start -->

<p>The maximum likelihood estimator is a <strong>technology</strong>: under regularity conditions, any MLE is asymptotically normal with variance given by the inverse Fisher information. <code>algebraic.mle</code> exploits that structure by defining an <strong>algebra</strong> over MLEs — you can compose them, combine them, transform them, and convert them to distribution objects, all while propagating uncertainty automatically.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"algebraic.mle"</span><span class="op">)</span></span></code></pre></div>
<p>Or the development version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"queelius/algebraic.mle"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.mle" class="external-link">algebraic.mle</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.dist" class="external-link">algebraic.dist</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-algebra">The algebra<a class="anchor" aria-label="anchor" href="#the-algebra"></a>
</h2>
<div class="section level3">
<h3 id="joint--compose-independent-experiments">
<code>joint()</code> — compose independent experiments<a class="anchor" aria-label="anchor" href="#joint--compose-independent-experiments"></a>
</h3>
<p>Two labs estimate different parameters from independent experiments. <code><a href="reference/joint.html">joint()</a></code> concatenates the parameter vectors and produces a block-diagonal covariance:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">2.1</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.04</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">50L</span><span class="op">)</span></span>
<span><span class="va">fit_shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle.html">mle</a></span><span class="op">(</span></span>
<span>  theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1.5</span>, s <span class="op">=</span> <span class="fl">3.2</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.02</span>,</span>
<span>                    <span class="fl">0.02</span>, <span class="fl">0.30</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  nobs <span class="op">=</span> <span class="fl">100L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/joint.html">joint</a></span><span class="op">(</span><span class="va">fit_rate</span>, <span class="va">fit_shape</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span></span>
<span><span class="co">#&gt; lambda      k      s </span></span>
<span><span class="co">#&gt;    2.1    1.5    3.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.04 0.00 0.00</span></span>
<span><span class="co">#&gt; [2,] 0.00 0.10 0.02</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.02 0.30</span></span></code></pre></div>
<p>The off-diagonal blocks are zero because the experiments are independent.</p>
</div>
<div class="section level3">
<h3 id="combine--pool-repeated-estimates">
<code>combine()</code> — pool repeated estimates<a class="anchor" aria-label="anchor" href="#combine--pool-repeated-estimates"></a>
</h3>
<p>Three labs each estimate the same rate parameter. <code><a href="reference/combine.html">combine()</a></code> uses inverse-variance weighting to produce the minimum-variance unbiased combination:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">2.1</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.04</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">50L</span><span class="op">)</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">1.9</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span></span>
<span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.03</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">70L</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/combine.html">combine</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit2</span>, <span class="va">fit3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">comb</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lambda </span></span>
<span><span class="co">#&gt; 1.976923</span></span>
<span><span class="fu"><a href="reference/se.html">se</a></span><span class="op">(</span><span class="va">comb</span><span class="op">)</span>             <span class="co"># smaller than any individual SE</span></span>
<span><span class="co">#&gt; [1] 0.09607689</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="reference/se.html">se</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>, <span class="fu"><a href="reference/se.html">se</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>, <span class="fu"><a href="reference/se.html">se</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2000000 0.1414214 0.1732051</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rmap--transform-via-the-delta-method">
<code>rmap()</code> — transform via the delta method<a class="anchor" aria-label="anchor" href="#rmap--transform-via-the-delta-method"></a>
</h3>
<p>The MLE of any smooth function of the parameters is the function applied to the MLE (invariance property). <code><a href="https://queelius.github.io/algebraic.dist/reference/rmap.html" class="external-link">rmap()</a></code> propagates uncertainty through the Jacobian:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MLE for an exponential rate</span></span>
<span><span class="va">fit_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.08</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">50L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transform rate to mean lifetime: E[T] = 1/lambda</span></span>
<span><span class="va">mean_life</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/rmap.html" class="external-link">rmap</a></span><span class="op">(</span><span class="va">fit_exp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean_life <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">mean_life</span><span class="op">)</span></span>
<span><span class="co">#&gt; mean_life </span></span>
<span><span class="co">#&gt;       0.5</span></span>
<span><span class="fu"><a href="reference/se.html">se</a></span><span class="op">(</span><span class="va">mean_life</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.07071068</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mean_life</span><span class="op">)</span></span>
<span><span class="co">#&gt;                2.5%     97.5%</span></span>
<span><span class="co">#&gt; mean_life 0.3614096 0.6385904</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="as_dist--bridge-to-distribution-algebra">
<code>as_dist()</code> — bridge to distribution algebra<a class="anchor" aria-label="anchor" href="#as_dist--bridge-to-distribution-algebra"></a>
</h3>
<p>Convert an MLE to its asymptotic normal distribution, then use the full distribution algebra from <code>algebraic.dist</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/as_dist.html" class="external-link">as_dist</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>   <span class="co"># Normal(2.1, 0.04)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/as_dist.html" class="external-link">as_dist</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>   <span class="co"># Normal(1.9, 0.02)</span></span>
<span></span>
<span><span class="co"># Sum of independent normals is normal</span></span>
<span><span class="va">d_sum</span> <span class="op">&lt;-</span> <span class="va">d1</span> <span class="op">+</span> <span class="va">d2</span></span>
<span><span class="va">d_sum</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 4, var = 0.06)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="inference">Inference<a class="anchor" aria-label="anchor" href="#inference"></a>
</h2>
<p>All MLE objects support a common interface for statistical inference:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle.html">mle</a></span><span class="op">(</span></span>
<span>  theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">5.1</span>, sigma2 <span class="op">=</span> <span class="fl">3.8</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.29</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  loglike <span class="op">=</span> <span class="op">-</span><span class="fl">154.3</span>,</span>
<span>  nobs <span class="op">=</span> <span class="fl">100L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;            2.5%    97.5%</span></span>
<span><span class="co">#&gt; mu     4.708007 5.491993</span></span>
<span><span class="co">#&gt; sigma2 2.744527 4.855473</span></span>
<span><span class="fu"><a href="reference/se.html">se</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2000000 0.5385165</span></span>
<span><span class="fu"><a href="reference/aic.html">aic</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 312.6</span></span></code></pre></div>
<p>Draw samples from the asymptotic distribution:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/sampler.html" class="external-link">sampler</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">samp</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]     [,2]</span></span>
<span><span class="co">#&gt; [1,] 4.881999 3.464467</span></span>
<span><span class="co">#&gt; [2,] 5.199934 3.735020</span></span>
<span><span class="co">#&gt; [3,] 5.067908 4.302101</span></span>
<span><span class="co">#&gt; [4,] 4.964794 3.924047</span></span>
<span><span class="co">#&gt; [5,] 5.059629 2.571551</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-mle-objects">Creating MLE objects<a class="anchor" aria-label="anchor" href="#creating-mle-objects"></a>
</h2>
<div class="section level3">
<h3 id="mle--direct-construction">
<code>mle()</code> — direct construction<a class="anchor" aria-label="anchor" href="#mle--direct-construction"></a>
</h3>
<p>When you know the point estimate and variance-covariance (e.g., from analytical results), construct directly:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle.html">mle</a></span><span class="op">(</span></span>
<span>  theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">5.0</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.04</span><span class="op">)</span>,</span>
<span>  loglike <span class="op">=</span> <span class="op">-</span><span class="fl">120.5</span>,</span>
<span>  nobs <span class="op">=</span> <span class="fl">100L</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum likelihood estimator of type mle is normally distributed.</span></span>
<span><span class="co">#&gt; The estimates of the parameters are given by:</span></span>
<span><span class="co">#&gt; mu </span></span>
<span><span class="co">#&gt;  5 </span></span>
<span><span class="co">#&gt; The standard error is  0.2 .</span></span>
<span><span class="co">#&gt; The asymptotic 95% confidence interval of the parameters are given by:</span></span>
<span><span class="co">#&gt;        2.5%    97.5%</span></span>
<span><span class="co">#&gt; mu 4.608007 5.391993</span></span>
<span><span class="co">#&gt; The MSE of the estimator is  0.04 .</span></span>
<span><span class="co">#&gt; The log-likelihood is  -120.5 .</span></span>
<span><span class="co">#&gt; The AIC is  243 .</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mle_numerical--wrap-optim-output">
<code>mle_numerical()</code> — wrap <code>optim()</code> output<a class="anchor" aria-label="anchor" href="#mle_numerical--wrap-optim-output"></a>
</h3>
<p>Fit a conditional exponential model <code>Y | x ~ Exp(rate(x))</code> where <code>rate(x) = exp(b0 + b1 * x)</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data from the model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1231</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">75</span></span>
<span><span class="va">b0_true</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.1</span></span>
<span><span class="va">b1_true</span> <span class="op">&lt;-</span>  <span class="fl">0.5</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">b0_true</span> <span class="op">+</span> <span class="va">b1_true</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define log-likelihood</span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span>, rate <span class="op">=</span> <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Fit and wrap</span></span>
<span><span class="va">par0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fl">0</span>, b1 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle_numerical.html">mle_numerical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="va">par0</span>,</span>
<span>  fn <span class="op">=</span> <span class="va">loglik</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum likelihood estimator of type mle_numerical is normally distributed.</span></span>
<span><span class="co">#&gt; The estimates of the parameters are given by:</span></span>
<span><span class="co">#&gt;         b0         b1 </span></span>
<span><span class="co">#&gt; -0.1425359  0.5226732 </span></span>
<span><span class="co">#&gt; The standard error is  0.1154688 0.01986773 .</span></span>
<span><span class="co">#&gt; The asymptotic 95% confidence interval of the parameters are given by:</span></span>
<span><span class="co">#&gt;          2.5%      97.5%</span></span>
<span><span class="co">#&gt; b0 -0.3688506 0.08377888</span></span>
<span><span class="co">#&gt; b1  0.4837332 0.56161328</span></span>
<span><span class="co">#&gt; The MSE of the individual components in a multivariate estimator is:</span></span>
<span><span class="co">#&gt;              [,1]         [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.333305e-02 4.876544e-05</span></span>
<span><span class="co">#&gt; [2,] 4.876544e-05 3.947267e-04</span></span>
<span><span class="co">#&gt; The log-likelihood is  -90.58435 .</span></span>
<span><span class="co">#&gt; The AIC is  185.1687 .</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="co">#&gt;          2.5%      97.5%</span></span>
<span><span class="co">#&gt; b0 -0.3688506 0.08377888</span></span>
<span><span class="co">#&gt; b1  0.4837332 0.56161328</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mle_boot--bootstrap-mle">
<code>mle_boot()</code> — bootstrap MLE<a class="anchor" aria-label="anchor" href="#mle_boot--bootstrap-mle"></a>
</h3>
<p>When sample size is small or regularity conditions are in doubt, use the bootstrap:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">30</span>, rate <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">boot_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">idx</span><span class="op">)</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">x</span>, statistic <span class="op">=</span> <span class="va">boot_fn</span>, R <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span>
<span><span class="va">fit_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mle_boot.html">mle_boot</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit_boot</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.019028</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_boot</span>, type <span class="op">=</span> <span class="st">"perc"</span><span class="op">)</span></span>
<span><span class="co">#&gt;            2.5%    97.5%</span></span>
<span><span class="co">#&gt; param1 1.367237 3.175378</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="links">Links<a class="anchor" aria-label="anchor" href="#links"></a>
</h2>
<ul>
<li><a href="https://queelius.github.io/algebraic.mle/">Package documentation</a></li>
<li><a href="https://queelius.github.io/algebraic.mle/articles/index.html">Vignettes</a></li>
<li><a href="https://queelius.github.io/algebraic.mle/reference/index.html">Function reference</a></li>
<li><a href="https://github.com/queelius/algebraic.mle" class="external-link">GitHub repository</a></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=algebraic.mle" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/queelius/algebraic.mle/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/queelius/algebraic.mle/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing algebraic.mle</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alexander Towell <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-6443-9897" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/license-GPL--3-blue.svg" alt="GPL-3 License"></a></li>
<li><a href="https://github.com/queelius/algebraic.mle/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/queelius/algebraic.mle/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
