<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="algebraic.mle">
<title>Exponential distribution MLE • algebraic.mle</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exponential distribution MLE">
<meta property="og:description" content="algebraic.mle">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">algebraic.mle</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/exponential-mle.html">Exponential distribution MLE</a>
    <a class="dropdown-item" href="../articles/normal-mle.html">Normal distribution MLE</a>
    <a class="dropdown-item" href="../articles/unknow_dgp.html">Fitting models to unknown DGPs</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/queelius/algebraic.mle/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Exponential distribution MLE</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/algebraic.mle/blob/HEAD/vignettes/exponential-mle.Rmd" class="external-link"><code>vignettes/exponential-mle.Rmd</code></a></small>
      <div class="d-none name"><code>exponential-mle.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>To demonstrate the R package <code>algebraic.mle</code>, we consider
the relatively simple case of a random sample from i.i.d. exponentially
distributed random variables. We show how to generate a sample, how to
estimate the rate parameter of the exponential distribution, and how to
compute the performance measures of the MLE. We also show how to compute
the sampling distribution of the MLE.</p>
<p>First, we load the R package <code>algebraic.mle</code>, along with
other R packages we need, with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.mle" class="external-link">algebraic.mle</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dgp-and-generating-samples">DGP and generating samples<a class="anchor" aria-label="anchor" href="#dgp-and-generating-samples"></a>
</h2>
<p>We consider the exponential distribution with rate parameter <span class="math inline">\(\lambda\)</span>. The exponential distribution has
pdf given by <span class="math inline">\(f(x) = \lambda \exp(-\lambda
x)\)</span> for <span class="math inline">\(x \geq 0\)</span> and <span class="math inline">\(f(x) = 0\)</span> otherwise. The exponential
distribution is unimodal and has a single parameter, <span class="math inline">\(\lambda\)</span>, which is the rate parameter. The
exponential distribution is a continuous distribution.</p>
<p>We have control of the rate parameter <span class="math inline">\(\lambda\)</span> in the DGP (data generating
process). In the following R code, we specity the DGP parameters for the
exponential distribution:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">rate</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></code></pre></div>
<p>This denotes that we have a sample of size <span class="math inline">\(n=25\)</span> from an exponential distribution
with rate parameter <span class="math inline">\(\lambda=3\)</span>. We
set the seed for the random number generator with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></code></pre></div>
<p>We generate a random sample <span class="math inline">\(X_i \sim
\operatorname{EXP}(\lambda=3)\)</span> for <span class="math inline">\(i=1,\ldots,n\)</span> with the following R
code:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">rate</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We have observed a sample of size <span class="math inline">\(n=25\)</span> from an exponential distribution
with rate parameter <span class="math inline">\(\lambda=3\)</span>. We
show some observations from this sample (data frame) with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span>,n<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 1</span></span></span>
<span><span class="co">#&gt;        x</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0.066<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 0.220 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 0.094<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 0.012<span style="text-decoration: underline;">7</span></span></span></code></pre></div>
<p>The pdf of the exponential distribution is given by <span class="math display">\[
    f(x;\lambda) = \lambda \exp(-\lambda x)
\]</span> for <span class="math inline">\(x \geq 0\)</span> and <span class="math inline">\(f(x;\lambda) = 0\)</span> otherwise. We show a
histogram of the sample overlaid with a plot of the exponential
function’s pdf:
<img src="exponential-mle_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Next, we show how to estimate the rate parameter <span class="math inline">\(\lambda\)</span> of the exponential
distribution.</p>
</div>
<div class="section level2">
<h2 id="maximum-likelihood-estimation">Maximum likelihood estimation<a class="anchor" aria-label="anchor" href="#maximum-likelihood-estimation"></a>
</h2>
<p>The MLE is the value of <span class="math inline">\(\lambda\)</span>
that maximizes the likelihood function <span class="math display">\[
    L(\lambda) = \prod_{i=1}^n f(x_i;\lambda).
\]</span> We normally work with the log-likelihood function instead of
the likelihood function. Since the log-likelihood function is a monotone
increasing function, the MLE is the value of <span class="math inline">\(\lambda\)</span> that maximizes the log-likelihood
function, <span class="math display">\[
    \ell(\lambda) = \sum_{i=1}^n \log f(x_i;\lambda) = \sum_{i=1}^n
        \log \lambda - \lambda x_i.
\]</span></p>
<p>To find the value that maximizes <span class="math inline">\(\ell\)</span>, we take the derivative of <span class="math inline">\(\ell\)</span> with respect to <span class="math inline">\(\lambda\)</span> and set it equal to zero. We
obtain the following equation: <span class="math display">\[
    \frac{1}{\lambda} \sum_{i=1}^n x_i = n.
\]</span> This equation has a unique solution, which is the MLE of the
rate parameter <span class="math inline">\(\lambda\)</span> of the
exponential distribution. Thus, the MLE of the rate parameter <span class="math inline">\(\lambda\)</span> of the exponential distribution
is given by <span class="math display">\[
    \hat\lambda = \frac{1}{n} \sum_{i=1}^n x_i.
\]</span></p>
<p>The <code>algebraic.mle</code> package provides a function
<code>mle_exp_rate</code> that computes the MLE of the rate parameter
<span class="math inline">\(\lambda\)</span> of the exponential
distribution. Since <code>mle_exp_rate</code> returns an
<code>mle</code> object, we can use various methods and functions on it,
like the <code>summary</code> function, to help us understand the MLE
point estimate and its sampling distribution.</p>
<p>We can compute the MLE of the rate parameter <span class="math inline">\(\lambda\)</span> of the exponential distribution
with:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle_exp_rate.html">mle_exp_rate</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>Here is how to get a summary of the MLE:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum likelihood estimator of type mle_exp_rate is normally distributed.</span></span>
<span><span class="co">#&gt; The estimates of the parameters are given by:</span></span>
<span><span class="co">#&gt;     rate </span></span>
<span><span class="co">#&gt; 2.896701 </span></span>
<span><span class="co">#&gt; The standard error is  0.5793401 .</span></span>
<span><span class="co">#&gt; The asymptotic 95% confidence interval of the parameters are given by:</span></span>
<span><span class="co">#&gt;          2.5%   97.5%</span></span>
<span><span class="co">#&gt; rate 1.943771 3.84963</span></span>
<span><span class="co">#&gt; The MSE of the estimator is  0.01456749 .</span></span>
<span><span class="co">#&gt; The log-likelihood is  1.589309 .</span></span>
<span><span class="co">#&gt; The AIC is  -1.178618 .</span></span></code></pre></div>
<p>The MLE of the rate parameter <span class="math inline">\(\lambda\)</span> of the exponential distribution
is <span class="math inline">\(\hat\lambda=2.8967006\)</span>, which may
be computed with the <code>point</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/point.html">point</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span></span>
<span><span class="co">#&gt;     rate </span></span>
<span><span class="co">#&gt; 2.896701</span></span></code></pre></div>
<p>In the next section, we show how to estimate the sampling
distribution of the MLE <span class="math inline">\(\hat\lambda\)</span>. We also show how to compute
the performance measures of the MLE.</p>
<div class="section level3">
<h3 id="sampling-distribution-of-the-mle">Sampling distribution of the MLE<a class="anchor" aria-label="anchor" href="#sampling-distribution-of-the-mle"></a>
</h3>
<p>In general, to estimate the sampling distribution, we generate <span class="math inline">\(B=10000\)</span> samples (of size <span class="math inline">\(25\)</span>) and their corresponding estimators,
<span class="math inline">\(\hat\theta^{(1)},\ldots,\hat\theta^{(B)}\)</span>.</p>
<p>Normally, we do not have <span class="math inline">\(B\)</span>
samples, and if we did, we would gather all <span class="math inline">\(B\)</span> samples into one sample (or used a
weighted MLE), which would contain more (Fisher) information about <span class="math inline">\(\theta\)</span>.</p>
<p>However, a nice property of MLEs is that, asymptotically, they
converge to a normal distribution with a mean given by the true
parameter, in this case <span class="math inline">\(\lambda\)</span>,
and a variance-covariance given by the inverse of the Fisher information
matrix <span class="math inline">\(I\)</span>, in this case <span class="math inline">\(I(\lambda) = n/\lambda^2\)</span>, i.e., <span class="math inline">\(\hat\lambda \sim
N(\lambda,I^{-1}(\lambda))\)</span>.</p>
<p>We observe the empirical sampling distribution of <span class="math inline">\(\hat\theta\)</span> overlaid with the theoretical
asymptotic distribution with:
<img src="exponential-mle_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We do not know <span class="math inline">\(\lambda\)</span>, but we
may estimate it from a sample, and thus we may approximate the sampling
distribution of <span class="math inline">\(\hat\lambda\)</span> with
<span class="math inline">\(N(\hat\lambda,I^{-1}(\hat\lambda))\)</span>.</p>
<p>We can compute the Fisher information and variance-covariance
matrices with:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fim.html">fim</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span></span>
<span><span class="co">#&gt;     rate </span></span>
<span><span class="co">#&gt; 2.979427</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span></span>
<span><span class="co">#&gt;     rate </span></span>
<span><span class="co">#&gt; 0.335635</span></span></code></pre></div>
<blockquote>
<p>NOTE: If <code>rate.hat</code> had been a vector, <code>vcov</code>
would have returned a matrix of variances and covariances, with the
variances on the diagonal. (We may consider the above <span class="math inline">\(1 \times 1\)</span> matrices.)</p>
</blockquote>
<p>Since we are only giving one sample, we cannot do as we did before to
provide <span class="math inline">\(B\)</span> estimates of <span class="math inline">\(\lambda\)</span>. However, we can sample from the
approximation of the asymptotic distribution of <span class="math inline">\(\hat\lambda\)</span> with:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span></code></pre></div>
<p>We visually compare the two MLE samples, <code>data0</code> and
<code>data1</code>, with:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data0</span>,<span class="va">data1</span><span class="op">)</span>,</span>
<span>    group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"empirical"</span>,<span class="va">B</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"approximation"</span>,<span class="va">B</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">values</span>,fill<span class="op">=</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>,position<span class="op">=</span><span class="st">"identity"</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, bins<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p><img src="exponential-mle_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Due to sampling error, we see that the approximation, the estimate of
the asymptotic sampling distribution <span class="math inline">\(N(\hat\lambda,\hat\lambda/n^{1/2})\)</span>, is
shifted to the left of the sample from the true distribution, but they
appear to be quite similar otherwise.</p>
</div>
<div class="section level3">
<h3 id="performance-measures-of-the-mle">Performance measures of the MLE<a class="anchor" aria-label="anchor" href="#performance-measures-of-the-mle"></a>
</h3>
<p>We can show the confidence interval with:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span></span>
<span><span class="co">#&gt;          2.5%   97.5%</span></span>
<span><span class="co">#&gt; rate 1.943771 3.84963</span></span></code></pre></div>
<p>The smaller the confidence interval, the better the estimator.</p>
<p>The bias <span class="math inline">\(b(\hat\lambda,\lambda) =
E(\hat\lambda) - \lambda\)</span> is another way of measuring the
performance of an estimator. Ideally, the bias is zero for all
components being estimated. In the MLE, the bias is asymptotically zero,
but for small samples may be quite biased.</p>
<p>For the exponential distribution’s rate parameter, the MLE is biased.
Here’s R code to compute an estimate of the bias of <span class="math inline">\(\hat\lambda\)</span> and and the true bias of
<span class="math inline">\(\hat\lambda\)</span>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bias.html">bias</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span></span>
<span><span class="co">#&gt; bias(rate) </span></span>
<span><span class="co">#&gt;  0.1206959</span></span>
<span><span class="fu"><a href="../reference/bias.html">bias</a></span><span class="op">(</span><span class="va">rate.hat</span>,<span class="va">rate</span><span class="op">)</span></span>
<span><span class="co">#&gt; bias(rate) </span></span>
<span><span class="co">#&gt;      0.125</span></span></code></pre></div>
<p>In this, they are similar.</p>
<p>The mean squared error (MSE) is another performance measure of an
estimator. It is given by <span class="math display">\[
    \operatorname{mse}(\hat\lambda) = E\bigl\{(\hat\lambda -
\lambda)^2)\bigr\},
\]</span> which is not the same as the variance <span class="math display">\[
    \operatorname{var}(\hat\lambda) = E\bigl\{(\hat\lambda -
E(\hat\lambda))^2)\bigr\},
\]</span> since the variance only accounts for the estimators spread
around its central tendency (which may be biased). Another way to
compute the MSE is given by <span class="math display">\[
    \operatorname{mse}(\hat\lambda) = \operatorname{var}(\hat\lambda) +
        \operatorname{bias}(\hat\lambda,\lambda)^2.
\]</span> We may, of course, have to estimate the MSE if the <span class="math inline">\(\lambda\)</span> is not known by replacing the
bias with an estimate of the bias, as discussed previously.</p>
<p>Here’s R code to compute the MSE of <span class="math inline">\(\hat\lambda\)</span>, an estimate of the MSE and
the true MSE:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">mse.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mse.html">mse</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01456749</span></span>
<span><span class="op">(</span><span class="va">mse.true</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mse.html">mse</a></span><span class="op">(</span><span class="va">rate.hat</span>,<span class="va">rate</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.015625</span></span></code></pre></div>
<p>They are quite similar in this case.</p>
</div>
</div>
<div class="section level2">
<h2 id="prediction-intervals">Prediction intervals<a class="anchor" aria-label="anchor" href="#prediction-intervals"></a>
</h2>
<p>Frequently, we are actually interested in predicting the outcome of
the random variable (or vector) that we are estimating the parameters
of.</p>
<p>We observed a sample <span class="math inline">\(\mathcal{D} =
\{T_i\}_{i=1}^n\)</span> where <span class="math inline">\(T_i \sim
\operatorname{EXP}(\lambda)\)</span>, <span class="math inline">\(\lambda\)</span> not known. To estimate <span class="math inline">\(\lambda\)</span>, we derive the MLE <span class="math display">\[
    \hat\lambda = \frac{1}{\bar{\mathcal{D}}},
\]</span> which, asymptotically, is normally distributed with a mean
<span class="math inline">\(\lambda\)</span> and a variance <span class="math inline">\(\lambda^2/n\)</span>.</p>
<p>We wish to model the uncertainty of a new observation, <span class="math inline">\(\hat{T}_{n+1}|\mathcal{D}\)</span>. We do so by
considering both the uncertainty inherent to the exponential
distribution and the uncertainty of our estimate <span class="math inline">\(\hat\lambda\)</span> of <span class="math inline">\(\lambda\)</span>. In particular, we let <span class="math inline">\(\hat{T}_{n+1}|\hat\lambda \sim
\operatorname{EXP}(\hat\lambda)\)</span> and <span class="math inline">\(\hat\lambda \sim N(\lambda,\lambda^2/n)\)</span>
(the sampling distribution of the MLE). Then, the joint distribution of
<span class="math inline">\(\hat{T}_{n+1}\)</span> and <span class="math inline">\(\hat\lambda\)</span> has the pdf given by <span class="math display">\[
    f(t,\lambda) = f_{\hat{T}|\hat\lambda}(t|\lambda)
f_{\hat\lambda}(\lambda),
\]</span> and thus to find <span class="math inline">\(f(t)\)</span>, we
marginalize over <span class="math inline">\(\lambda\)</span>, obtaining
<span class="math display">\[
    f(t) = \int_{-\infty}^{\infty} f_{\hat{T}_{n+1},\hat\lambda}(t,r)
dr.
\]</span></p>
<p>Given the information in the sample, the uncertainty in the new
observation is characterized by the distribution <span class="math display">\[
    \hat{T}_{n+1} \sim f(t).
\]</span></p>
<p>It has greater variance than <span class="math inline">\(T_{n+1}|\hat\lambda \sim
\operatorname{EXP}(\hat\lambda)\)</span> because, as stated earlier, we
do not know <span class="math inline">\(\lambda\)</span>, we only have
an uncertain estimate <span class="math inline">\(\hat\lambda\)</span>.</p>
<p>In <code>pred</code>, we compute the predictive interval (PI) of the
distribution of <span class="math inline">\(\hat{T}_{n+1}\)</span> using
Monte Carlo simulation, where we replace the integral with a sum over a
large number of draws from the joint distribution of <span class="math inline">\(\hat{T}_{n+1}\)</span> and <span class="math inline">\(\hat\lambda\)</span> and then compute the
empirical quantiles.</p>
<p>The function <code>pred</code> takes as arguments <code>x</code>, in
this case an <code>mle</code> object, and a sampler for the distribution
of the random variable of interest, in this case <code>rexp</code> (the
sampler for the exponential distribution). The sampler must be
compatible with the parameter value of <code>x</code> (i.e.,
<code>point(x)</code>). Here is how we compute the PI for <span class="math inline">\(\hat{T}_{n+1}\)</span>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle_exp_rate.html">mle_exp_rate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">rate</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pred.html">pred</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">rate.hat</span>,samp<span class="op">=</span><span class="va">rexp</span><span class="op">)</span></span>
<span><span class="co">#&gt;           mean       lower    upper</span></span>
<span><span class="co">#&gt; [1,] 0.3544321 0.008480229 1.370407</span></span></code></pre></div>
<p>How does this compare to <span class="math inline">\(T_{n+1}|\hat\lambda \sim
\operatorname{EXP}(\hat\lambda = 2.9628807)\)</span>?</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q.95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="../reference/point.html">point</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">qexp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.025</span>,<span class="fl">.975</span><span class="op">)</span>,<span class="fu"><a href="../reference/point.html">point</a></span><span class="op">(</span><span class="va">rate.hat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">q.95</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>,<span class="st">"lower"</span>, <span class="st">"upper"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">q.95</span><span class="op">)</span></span>
<span><span class="co">#&gt;        mean       lower       upper </span></span>
<span><span class="co">#&gt; 0.337509375 0.008544998 1.245031398</span></span></code></pre></div>
<p>We see that the 95% quantile interval for <span class="math inline">\(T_{n+1}|\hat\lambda\)</span> is a bit smaller than
<span class="math inline">\(\hat{T}_{n+1}\)</span>, which is what we
expected. Of course, for sufficiently large sample sizes, they will
converge to the same quantiles.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
