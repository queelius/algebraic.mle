<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Algebra of MLEs • algebraic.mle</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Algebra of MLEs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">algebraic.mle</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/dgp.html">Dynamic failure rate model</a></li>
    <li><a class="dropdown-item" href="../articles/fitting-common-dist.html">Fitting Common Distributions to a DGP</a></li>
    <li><a class="dropdown-item" href="../articles/mle-algebra.html">The Algebra of MLEs</a></li>
    <li><a class="dropdown-item" href="../articles/statistics.html">Statistics and characteristics of the MLE</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/queelius/algebraic.mle/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The Algebra of MLEs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/algebraic.mle/blob/master/vignettes/mle-algebra.Rmd" class="external-link"><code>vignettes/mle-algebra.Rmd</code></a></small>
      <div class="d-none name"><code>mle-algebra.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The maximum likelihood estimator (MLE) is a technology. Under
regularity conditions, any MLE is asymptotically normal:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><mi>I</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat\theta \sim N(\theta, I(\theta)^{-1})</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I(\theta)</annotation></semantics></math>
is the Fisher information matrix. This fact is remarkable because it
holds regardless of the underlying model – exponential, Weibull, normal,
or anything else. The MLE reduces the problem of inference to a mean
vector and a covariance matrix.</p>
<p><code>algebraic.mle</code> is the algebra that follows from this
fact. It does not find MLEs – it takes them as input and provides
operations for composition, transformation, and inference. Given two
independent experiments, <code><a href="../reference/joint.html">joint()</a></code> composes their MLEs into a
single joint estimator with block-diagonal covariance. Given three labs
estimating the same quantity, <code><a href="../reference/combine.html">combine()</a></code> produces the
optimal inverse-variance weighted estimate. Given a transformation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\theta)</annotation></semantics></math>,
<code><a href="https://queelius.github.io/algebraic.dist/reference/rmap.html" class="external-link">rmap()</a></code> propagates uncertainty through the delta method. And
<code><a href="https://queelius.github.io/algebraic.dist/reference/as_dist.html" class="external-link">as_dist()</a></code> bridges to the distribution algebra in
<code>algebraic.dist</code>, where normal distributions can be further
composed.</p>
<p>This vignette walks through each operation with concrete examples,
culminating in a full pipeline from independent experiments to system
reliability inference.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.mle" class="external-link">algebraic.mle</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-mles">Creating MLEs<a class="anchor" aria-label="anchor" href="#creating-mles"></a>
</h2>
<p>The package provides three constructors for wrapping estimation
results into the MLE algebra. Each produces an object that supports the
full interface: <code><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params()</a></code>, <code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code>,
<code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code>, <code><a href="../reference/se.html">se()</a></code>, <code><a href="../reference/aic.html">aic()</a></code>, and the
algebraic operations.</p>
<div class="section level3">
<h3 id="direct-construction-with-mle">Direct construction with <code>mle()</code><a class="anchor" aria-label="anchor" href="#direct-construction-with-mle"></a>
</h3>
<p>When you know the point estimate and its variance-covariance matrix
(e.g., from analytical results or published tables), construct an MLE
directly:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exponential rate from a published study: lambda_hat = 0.5, se = 0.07, n = 200</span></span>
<span><span class="va">fit_pub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span></span>
<span>  theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.07</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  nobs <span class="op">=</span> <span class="fl">200L</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit_pub</span><span class="op">)</span></span>
<span><span class="co">#&gt; lambda </span></span>
<span><span class="co">#&gt;    0.5</span></span>
<span><span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">fit_pub</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.07</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="from-numerical-optimization-with-mle_numerical">From numerical optimization with <code>mle_numerical()</code><a class="anchor" aria-label="anchor" href="#from-numerical-optimization-with-mle_numerical"></a>
</h3>
<p>The most common path: maximize a log-likelihood with
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>, then wrap the result. The Hessian at the optimum
gives the variance-covariance matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">80</span>, rate <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">rate</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">x</span>, rate <span class="op">=</span> <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  fn <span class="op">=</span> <span class="va">loglik</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Brent"</span>, lower <span class="op">=</span> <span class="fl">0.01</span>, upper <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle_numerical.html">mle_numerical</a></span><span class="op">(</span><span class="va">result</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit_num</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.687</span></span>
<span><span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">fit_num</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1886</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="from-bootstrap-with-mle_boot">From bootstrap with <code>mle_boot()</code><a class="anchor" aria-label="anchor" href="#from-bootstrap-with-mle_boot"></a>
</h3>
<p>When the sample is small or regularity conditions are questionable,
bootstrap the MLE and wrap the <code>boot</code> object:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">30</span>, rate <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">boot_result</span> <span class="op">&lt;-</span> <span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">y</span>,</span>
<span>  statistic <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span>, <span class="va">i</span><span class="op">)</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">999</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle_boot.html">mle_boot</a></span><span class="op">(</span><span class="va">boot_result</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit_boot</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.019</span></span>
<span><span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">fit_boot</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4629</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_boot</span>, type <span class="op">=</span> <span class="st">"perc"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         2.5% 97.5%</span></span>
<span><span class="co">#&gt; param1 1.367 3.175</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="composing-independent-mles">Composing Independent MLEs<a class="anchor" aria-label="anchor" href="#composing-independent-mles"></a>
</h2>
<p>When independent experiments measure different parameters of a
system, <code><a href="../reference/joint.html">joint()</a></code> composes their MLEs into a single joint
estimator. The result has a block-diagonal variance-covariance matrix
because the experiments are independent – there is no cross-covariance
between their parameter estimates.</p>
<p><strong>Motivating example</strong>: A series system has two
components. Lab A tests component 1 and estimates its failure rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>.
Lab B tests component 2 and estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math>.
Neither lab knows about the other component, but we need the joint
parameter vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\lambda_1, \lambda_2)</annotation></semantics></math>
for system-level inference.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lab A: component 1 failure rate</span></span>
<span><span class="va">fit_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span></span>
<span>  theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda1 <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.001</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  nobs <span class="op">=</span> <span class="fl">150L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lab B: component 2 failure rate</span></span>
<span><span class="va">fit_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span></span>
<span>  theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda2 <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.003</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  nobs <span class="op">=</span> <span class="fl">80L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Joint MLE: block-diagonal covariance</span></span>
<span><span class="va">fit_joint</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/joint.html">joint</a></span><span class="op">(</span><span class="va">fit_A</span>, <span class="va">fit_B</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit_joint</span><span class="op">)</span></span>
<span><span class="co">#&gt; lambda1 lambda2 </span></span>
<span><span class="co">#&gt;    0.02    0.05</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit_joint</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1]  [,2]</span></span>
<span><span class="co">#&gt; [1,] 1e-06 0e+00</span></span>
<span><span class="co">#&gt; [2,] 0e+00 9e-06</span></span></code></pre></div>
<p>The off-diagonal entries are zero – the hallmark of independence. The
joint MLE supports the full interface:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_joint</span><span class="op">)</span></span>
<span><span class="co">#&gt;            2.5%   97.5%</span></span>
<span><span class="co">#&gt; lambda1 0.01804 0.02196</span></span>
<span><span class="co">#&gt; lambda2 0.04412 0.05588</span></span>
<span><span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">fit_joint</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001 0.003</span></span></code></pre></div>
<p>Use <code><a href="https://queelius.github.io/algebraic.dist/reference/marginal.html" class="external-link">marginal()</a></code> to recover individual component estimates
from the joint:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recover component 2 parameters</span></span>
<span><span class="va">fit_B_recovered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/marginal.html" class="external-link">marginal</a></span><span class="op">(</span><span class="va">fit_joint</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit_B_recovered</span><span class="op">)</span></span>
<span><span class="co">#&gt; lambda2 </span></span>
<span><span class="co">#&gt;    0.05</span></span>
<span><span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">fit_B_recovered</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.003</span></span></code></pre></div>
<p><code><a href="../reference/joint.html">joint()</a></code> extends to any number of independent MLEs:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span></span>
<span>  theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda3 <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.0005</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  nobs <span class="op">=</span> <span class="fl">200L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_system</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/joint.html">joint</a></span><span class="op">(</span><span class="va">fit_A</span>, <span class="va">fit_B</span>, <span class="va">fit_C</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit_system</span><span class="op">)</span></span>
<span><span class="co">#&gt; lambda1 lambda2 lambda3 </span></span>
<span><span class="co">#&gt;    0.02    0.05    0.01</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combining-repeated-estimates">Combining Repeated Estimates<a class="anchor" aria-label="anchor" href="#combining-repeated-estimates"></a>
</h2>
<p>When multiple independent experiments estimate the
<strong>same</strong> parameter, <code><a href="../reference/combine.html">combine()</a></code> produces the
optimal estimator via inverse-variance weighting. The combined estimate
weights more precise estimates more heavily, and the combined variance
is always less than any individual variance.</p>
<p><strong>Motivating example</strong>: Three labs independently
estimate the failure rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
of the same component type.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lab1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.050</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.004</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">50L</span><span class="op">)</span></span>
<span><span class="va">lab2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.048</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.002</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">200L</span><span class="op">)</span></span>
<span><span class="va">lab3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.053</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.003</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine.html">combine</a></span><span class="op">(</span><span class="va">lab1</span>, <span class="va">lab2</span>, <span class="va">lab3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span></span>
<span><span class="co">#&gt;  lambda </span></span>
<span><span class="co">#&gt; 0.04961</span></span>
<span><span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001536</span></span></code></pre></div>
<p>The combined standard error is smaller than any individual standard
error:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Lab SEs:     "</span>, <span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">lab1</span><span class="op">)</span>, <span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">lab2</span><span class="op">)</span>, <span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">lab3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Lab SEs:      0.004 0.002 0.003</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Combined SE: "</span>, <span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Combined SE:  0.001536</span></span></code></pre></div>
<p>The combined estimate is pulled toward the more precise estimates.
Lab 2 has the smallest variance, so it receives the most weight.</p>
<p>When all estimates have equal precision, <code><a href="../reference/combine.html">combine()</a></code>
reduces to the simple average:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eq1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">10.0</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">eq2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">12.0</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">eq3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">11.0</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eq_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine.html">combine</a></span><span class="op">(</span><span class="va">eq1</span>, <span class="va">eq2</span>, <span class="va">eq3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">eq_combined</span><span class="op">)</span>  <span class="co"># (10 + 12 + 11) / 3 = 11</span></span>
<span><span class="co">#&gt; mu </span></span>
<span><span class="co">#&gt; 11</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="transformations-via-invariance">Transformations via Invariance<a class="anchor" aria-label="anchor" href="#transformations-via-invariance"></a>
</h2>
<p>By the invariance property of the MLE, if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat\theta</annotation></semantics></math>
is the MLE of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\hat\theta)</annotation></semantics></math>
is the MLE of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\theta)</annotation></semantics></math>
for any function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>.
The <code><a href="https://queelius.github.io/algebraic.dist/reference/rmap.html" class="external-link">rmap()</a></code> function computes this transformation and
propagates uncertainty using the delta method:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mi>J</mi><mspace width="0.167em"></mspace><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><msup><mi>J</mi><mi>⊤</mi></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\text{Var}(g(\hat\theta)) \approx J \, \text{Var}(\hat\theta) \, J^\top,
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
is the Jacobian of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
evaluated at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat\theta</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="univariate-example-rate-to-mean-lifetime">Univariate example: rate to mean lifetime<a class="anchor" aria-label="anchor" href="#univariate-example-rate-to-mean-lifetime"></a>
</h3>
<p>An exponential component has rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.
The mean lifetime is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>1</mn><mi>/</mi><mi>λ</mi></mrow><annotation encoding="application/x-tex">\mu = 1/\lambda</annotation></semantics></math>.
Transform the MLE:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span></span>
<span>  theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.001</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  nobs <span class="op">=</span> <span class="fl">150L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># g: rate -&gt; mean lifetime</span></span>
<span><span class="va">fit_lifetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/rmap.html" class="external-link">rmap</a></span><span class="op">(</span><span class="va">fit_rate</span>, <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit_lifetime</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 50</span></span>
<span><span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">fit_lifetime</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_lifetime</span><span class="op">)</span></span>
<span><span class="co">#&gt;        2.5% 97.5%</span></span>
<span><span class="co">#&gt; param1 45.1  54.9</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multivariate-example-component-rates-to-system-reliability">Multivariate example: component rates to system reliability<a class="anchor" aria-label="anchor" href="#multivariate-example-component-rates-to-system-reliability"></a>
</h3>
<p>For a series system with independent exponential components, the
system reliability at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>λ</mi><mn>1</mn></msub><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>λ</mi><mn>2</mn></msub><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
R(t) = \exp(-\lambda_1 t) \cdot \exp(-\lambda_2 t) = \exp(-(\lambda_1 + \lambda_2) t).
</annotation></semantics></math></p>
<p>Starting from the joint MLE of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\lambda_1, \lambda_2)</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/joint.html">joint</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda1 <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.001</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">150L</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda2 <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.003</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># System reliability at t = 100 hours</span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">R_mle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/rmap.html" class="external-link">rmap</a></span><span class="op">(</span><span class="va">fit_rates</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">t0</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"delta"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">R_mle</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0009119</span></span>
<span><span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">R_mle</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0002884</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">R_mle</span><span class="op">)</span></span>
<span><span class="co">#&gt;             2.5%    97.5%</span></span>
<span><span class="co">#&gt; param1 0.0003467 0.001477</span></span></code></pre></div>
<p>The delta method automatically computes the Jacobian via numerical
differentiation (using <code><a href="https://rdrr.io/pkg/numDeriv/man/jacobian.html" class="external-link">numDeriv::jacobian</a></code>) and propagates
the covariance.</p>
</div>
</div>
<div class="section level2">
<h2 id="bridging-to-distribution-algebra">Bridging to Distribution Algebra<a class="anchor" aria-label="anchor" href="#bridging-to-distribution-algebra"></a>
</h2>
<p><code><a href="https://queelius.github.io/algebraic.dist/reference/as_dist.html" class="external-link">as_dist()</a></code> converts an MLE to its asymptotic normal (or
multivariate normal) distribution, bridging into the
<code>algebraic.dist</code> package where distributions can be further
composed.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle.html">mle</a></span><span class="op">(</span>theta.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.001</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/as_dist.html" class="external-link">as_dist</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="va">d1</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 0.02, var = 1e-06)</span></span></code></pre></div>
<p>This is useful when you want to reason about the sampling
distribution of the MLE as a distribution object. For instance, you can
compute probabilities that the true parameter exceeds a threshold:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P(lambda &gt; 0.025) under the asymptotic distribution</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/cdf.html" class="external-link">cdf</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.867e-07</span></span></code></pre></div>
<p>For bootstrap MLEs, <code><a href="https://queelius.github.io/algebraic.dist/reference/as_dist.html" class="external-link">as_dist()</a></code> returns an empirical
distribution built from the bootstrap replicates:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/as_dist.html" class="external-link">as_dist</a></span><span class="op">(</span><span class="va">fit_boot</span><span class="op">)</span></span>
<span><span class="va">d_boot</span></span>
<span><span class="co">#&gt; Empirical distribution (999 observations, 1 dimensions)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="full-pipeline">Full Pipeline<a class="anchor" aria-label="anchor" href="#full-pipeline"></a>
</h2>
<p>Here is an end-to-end example tying together all the algebraic
operations.</p>
<p><strong>Scenario</strong>: A series system has two independent
components with exponential lifetimes. Separate accelerated life tests
estimate each component’s failure rate. We want to infer the system
reliability at a mission time of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">t = 500</annotation></semantics></math>
hours, including a confidence interval.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Step 1: Independent MLEs from separate experiments ---</span></span>
<span></span>
<span><span class="co"># Component 1: 200 observed lifetimes</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">200</span>, rate <span class="op">=</span> <span class="fl">0.003</span><span class="op">)</span></span>
<span><span class="va">loglik1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">rate</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">x1</span>, rate <span class="op">=</span> <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle_numerical.html">mle_numerical</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda1 <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>, fn <span class="op">=</span> <span class="va">loglik1</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"Brent"</span>, lower <span class="op">=</span> <span class="fl">1e-6</span>, upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        hessian <span class="op">=</span> <span class="cn">TRUE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Component 2: 120 observed lifetimes</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">120</span>, rate <span class="op">=</span> <span class="fl">0.008</span><span class="op">)</span></span>
<span><span class="va">loglik2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">rate</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">x2</span>, rate <span class="op">=</span> <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle_numerical.html">mle_numerical</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda2 <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>, fn <span class="op">=</span> <span class="va">loglik2</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"Brent"</span>, lower <span class="op">=</span> <span class="fl">1e-6</span>, upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        hessian <span class="op">=</span> <span class="cn">TRUE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Component 1 rate:"</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>, <span class="st">"  SE:"</span>, <span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Component 1 rate: 0.002978   SE: 0.0001827</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Component 2 rate:"</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>, <span class="st">"  SE:"</span>, <span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Component 2 rate: 0.007983   SE: 0.0007171</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- Step 2: Compose into joint parameter space ---</span></span>
<span><span class="va">fit_system</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/joint.html">joint</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Joint parameters:"</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit_system</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joint parameters: 0.002978 0.007983</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Joint vcov:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joint vcov:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit_system</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 3.336e-08 0.000e+00</span></span>
<span><span class="co">#&gt; [2,] 0.000e+00 5.142e-07</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- Step 3: Transform to system reliability at t = 500 ---</span></span>
<span><span class="va">mission_time</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">R_system</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/rmap.html" class="external-link">rmap</a></span><span class="op">(</span><span class="va">fit_system</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">mission_time</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"delta"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"System reliability R(500):"</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">R_system</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; System reliability R(500): 0.004167</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"SE of R(500):             "</span>, <span class="fu"><a href="../reference/se.html">se</a></span><span class="op">(</span><span class="va">R_system</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; SE of R(500):              0.001542</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- Step 4: Inference ---</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"95% CI for R(500):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 95% CI for R(500):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">R_system</span><span class="op">)</span></span>
<span><span class="co">#&gt;            2.5%    97.5%</span></span>
<span><span class="co">#&gt; param1 0.001145 0.007188</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- Step 5: Bridge to distribution algebra ---</span></span>
<span><span class="va">R_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/as_dist.html" class="external-link">as_dist</a></span><span class="op">(</span><span class="va">R_system</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Asymptotic distribution of R(500):"</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Asymptotic distribution of R(500):</span></span>
<span><span class="va">R_dist</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 0.00416658, var = 2.3765e-06)</span></span>
<span></span>
<span><span class="co"># Probability that system reliability exceeds 90%</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"P(R(500) &gt; 0.90):"</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/cdf.html" class="external-link">cdf</a></span><span class="op">(</span><span class="va">R_dist</span><span class="op">)</span><span class="op">(</span><span class="fl">0.90</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; P(R(500) &gt; 0.90): 0</span></span></code></pre></div>
<p>The pipeline reads as a chain of algebraic operations: two
independent MLEs are composed via <code><a href="../reference/joint.html">joint()</a></code>, transformed to
the quantity of interest via <code><a href="https://queelius.github.io/algebraic.dist/reference/rmap.html" class="external-link">rmap()</a></code>, and then reasoned
about as a distribution via <code><a href="https://queelius.github.io/algebraic.dist/reference/as_dist.html" class="external-link">as_dist()</a></code>. Each step preserves
the uncertainty structure inherited from the original experiments.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
